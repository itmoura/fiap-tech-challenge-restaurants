<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testes - Tech Challenge Restaurant API</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ§ª</text></svg>">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <a href="../" class="logo">
                    <span class="logo-icon">ğŸ½ï¸</span>
                    <div>
                        <div class="logo-text">Tech Challenge</div>
                        <div class="logo-subtitle">Restaurant API</div>
                    </div>
                </a>
            </div>
            
            <div class="nav-menu">
                <div class="nav-section">
                    <div class="nav-section-title">InÃ­cio</div>
                    <a href="../" class="nav-item">
                        <span class="nav-item-icon">ğŸ </span>
                        VisÃ£o Geral
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">InstalaÃ§Ã£o</div>
                    <a href="prerequisites.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ“‹</span>
                        PrÃ©-requisitos
                    </a>
                    <a href="local-setup.html" class="nav-item">
                        <span class="nav-item-icon">âš™ï¸</span>
                        ConfiguraÃ§Ã£o Local
                    </a>
                    <a href="docker.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ³</span>
                        Docker
                    </a>
                    <a href="testing.html" class="nav-item active">
                        <span class="nav-item-icon">ğŸ§ª</span>
                        Testes
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">API Reference</div>
                    <a href="api-overview.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ“š</span>
                        VisÃ£o Geral
                    </a>
                    <a href="kitchen-types.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ‘¨â€ğŸ³</span>
                        Kitchen Types
                    </a>
                    <a href="restaurants.html" class="nav-item">
                        <span class="nav-item-icon">ğŸª</span>
                        Restaurants
                    </a>
                    <a href="menu-categories.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ“‚</span>
                        Menu Categories
                    </a>
                    <a href="menu-items.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ•</span>
                        Menu Items
                    </a>
                    <a href="status-codes.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ“Š</span>
                        Status Codes
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">MicroserviÃ§os</div>
                    <a href="user-microservice.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ‘¥</span>
                        UsuÃ¡rios (MS)
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Arquitetura</div>
                    <a href="architecture-overview.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ—ï¸</span>
                        VisÃ£o Geral
                    </a>
                    <a href="clean-architecture.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ¯</span>
                        Clean Architecture
                    </a>
                    <a href="data-modeling.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ—„ï¸</span>
                        Modelagem de Dados
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Sobre</div>
                    <a href="author.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ‘¤</span>
                        Autor
                    </a>
                    <a href="license.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ“„</span>
                        LicenÃ§a
                    </a>
                    <a href="changelog.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ“</span>
                        Changelog
                    </a>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <nav class="breadcrumb">
                    <a href="../">Home</a>
                    <span>/</span>
                    <a href="#">InstalaÃ§Ã£o</a>
                    <span>/</span>
                    <span>Testes</span>
                </nav>
                <h1 class="page-title">ğŸ§ª Testes Automatizados</h1>
                <p class="page-description">Guia completo para executar e criar testes no projeto</p>
            </header>

            <div class="content-body">
                <!-- Quick Test -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">âš¡</span>
                        <h2 class="card-title">ExecuÃ§Ã£o RÃ¡pida</h2>
                    </div>
                    <div class="card-content">
                        <div class="code-block">
                            <pre># Executar todos os testes
./gradlew test

# Executar testes com relatÃ³rio de cobertura
./gradlew test jacocoTestReport

# Ver relatÃ³rio de cobertura
open build/reports/jacoco/test/html/index.html</pre>
                        </div>
                    </div>
                </div>

                <!-- Test Types -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">ğŸ¯</span>
                        <h2 class="card-title">Tipos de Teste</h2>
                    </div>
                    <div class="card-content">
                        <div class="feature-cards">
                            <div class="feature-card">
                                <div class="feature-card-icon">ğŸ§ª</div>
                                <h3 class="feature-card-title">Testes UnitÃ¡rios</h3>
                                <p class="feature-card-description">
                                    Testam componentes isolados com mocks
                                </p>
                            </div>

                            <div class="feature-card">
                                <div class="feature-card-icon">ğŸ”—</div>
                                <h3 class="feature-card-title">Testes de IntegraÃ§Ã£o</h3>
                                <p class="feature-card-description">
                                    Testam fluxos completos com banco real
                                </p>
                            </div>

                            <div class="feature-card">
                                <div class="feature-card-icon">ğŸŒ</div>
                                <h3 class="feature-card-title">Testes de API</h3>
                                <p class="feature-card-description">
                                    Testam endpoints REST completos
                                </p>
                            </div>

                            <div class="feature-card">
                                <div class="feature-card-icon">ğŸ³</div>
                                <h3 class="feature-card-title">Testes com Containers</h3>
                                <p class="feature-card-description">
                                    TestContainers para MongoDB real
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Running Tests -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">ğŸš€</span>
                        <h2 class="card-title">Executando Testes</h2>
                    </div>
                    <div class="card-content">
                        <h3 class="mb-1">ğŸ§ª Testes UnitÃ¡rios</h3>
                        <div class="code-block">
                            <pre># Executar apenas testes unitÃ¡rios
./gradlew test --tests "*Test"

# Executar testes de uma classe especÃ­fica
./gradlew test --tests "RestaurantServiceTest"

# Executar um teste especÃ­fico
./gradlew test --tests "RestaurantServiceTest.shouldCreateRestaurant"</pre>
                        </div>

                        <h3 class="mb-1 mt-2">ğŸ”— Testes de IntegraÃ§Ã£o</h3>
                        <div class="code-block">
                            <pre># Executar testes de integraÃ§Ã£o
./gradlew test --tests "*IntegrationTest"

# Executar com perfil de teste
./gradlew test -Dspring.profiles.active=test

# Executar com MongoDB em container
./gradlew test -Dtestcontainers.enabled=true</pre>
                        </div>

                        <h3 class="mb-1 mt-2">ğŸ“Š RelatÃ³rios de Cobertura</h3>
                        <div class="code-block">
                            <pre># Gerar relatÃ³rio de cobertura
./gradlew jacocoTestReport

# Verificar cobertura mÃ­nima
./gradlew jacocoTestCoverageVerification

# Ver relatÃ³rio HTML
open build/reports/jacoco/test/html/index.html

# Ver relatÃ³rio XML (para CI/CD)
cat build/reports/jacoco/test/jacocoTestReport.xml</pre>
                        </div>
                    </div>
                </div>

                <!-- Test Structure -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">ğŸ“</span>
                        <h2 class="card-title">Estrutura de Testes</h2>
                    </div>
                    <div class="card-content">
                        <div class="code-block">
                            <pre>src/test/java/
â”œâ”€â”€ com/fiap/itmoura/tech_challenge/
â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â”œâ”€â”€ RestaurantControllerTest.java
â”‚   â”‚   â”œâ”€â”€ KitchenTypeControllerTest.java
â”‚   â”‚   â””â”€â”€ MenuControllerTest.java
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â”œâ”€â”€ RestaurantServiceTest.java
â”‚   â”‚   â”œâ”€â”€ KitchenTypeServiceTest.java
â”‚   â”‚   â””â”€â”€ MenuServiceTest.java
â”‚   â”œâ”€â”€ repository/
â”‚   â”‚   â”œâ”€â”€ RestaurantRepositoryTest.java
â”‚   â”‚   â””â”€â”€ KitchenTypeRepositoryTest.java
â”‚   â”œâ”€â”€ integration/
â”‚   â”‚   â”œâ”€â”€ RestaurantIntegrationTest.java
â”‚   â”‚   â””â”€â”€ MenuIntegrationTest.java
â”‚   â””â”€â”€ util/
â”‚       â”œâ”€â”€ TestDataBuilder.java
â”‚       â””â”€â”€ TestContainerConfig.java</pre>
                        </div>
                    </div>
                </div>

                <!-- Test Configuration -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">âš™ï¸</span>
                        <h2 class="card-title">ConfiguraÃ§Ã£o de Testes</h2>
                    </div>
                    <div class="card-content">
                        <h3 class="mb-1">ğŸ“„ application-test.yml</h3>
                        <div class="code-block">
                            <pre>spring:
  data:
    mongodb:
      uri: mongodb://localhost:27017/restaurant_test_db
  
logging:
  level:
    com.fiap.itmoura.tech_challenge: DEBUG
    org.springframework.data.mongodb: DEBUG
    org.testcontainers: INFO

# TestContainers configuration
testcontainers:
  reuse:
    enable: true</pre>
                        </div>

                        <h3 class="mb-1 mt-2">ğŸ³ TestContainers Setup</h3>
                        <div class="code-block">
                            <pre>@Testcontainers
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
class RestaurantIntegrationTest {

    @Container
    static MongoDBContainer mongoDBContainer = new MongoDBContainer("mongo:7.0")
            .withReuse(true);

    @DynamicPropertySource
    static void configureProperties(DynamicPropertyRegistry registry) {
        registry.add("spring.data.mongodb.uri", mongoDBContainer::getReplicaSetUrl);
    }
}</pre>
                        </div>
                    </div>
                </div>

                <!-- Writing Tests -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">âœï¸</span>
                        <h2 class="card-title">Escrevendo Testes</h2>
                    </div>
                    <div class="card-content">
                        <h3 class="mb-1">ğŸ§ª Exemplo de Teste UnitÃ¡rio</h3>
                        <div class="code-block">
                            <pre>@ExtendWith(MockitoExtension.class)
class RestaurantServiceTest {

    @Mock
    private RestaurantRepository restaurantRepository;

    @InjectMocks
    private RestaurantService restaurantService;

    @Test
    @DisplayName("Should create restaurant successfully")
    void shouldCreateRestaurant() {
        // Given
        Restaurant restaurant = TestDataBuilder.createValidRestaurant();
        when(restaurantRepository.save(any(Restaurant.class)))
            .thenReturn(restaurant);

        // When
        Restaurant result = restaurantService.create(restaurant);

        // Then
        assertThat(result).isNotNull();
        assertThat(result.getName()).isEqualTo(restaurant.getName());
        verify(restaurantRepository).save(restaurant);
    }
}</pre>
                        </div>

                        <h3 class="mb-1 mt-2">ğŸ”— Exemplo de Teste de IntegraÃ§Ã£o</h3>
                        <div class="code-block">
                            <pre>@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@Testcontainers
class RestaurantIntegrationTest {

    @Autowired
    private TestRestTemplate restTemplate;

    @Autowired
    private RestaurantRepository restaurantRepository;

    @Test
    @DisplayName("Should create and retrieve restaurant")
    void shouldCreateAndRetrieveRestaurant() {
        // Given
        CreateRestaurantRequest request = CreateRestaurantRequest.builder()
            .name("Test Restaurant")
            .description("Test Description")
            .kitchenType("ITALIAN")
            .build();

        // When
        ResponseEntity&lt;RestaurantResponse&gt; response = restTemplate
            .postForEntity("/api/restaurants", request, RestaurantResponse.class);

        // Then
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.CREATED);
        assertThat(response.getBody().getName()).isEqualTo("Test Restaurant");
        
        // Verify in database
        List&lt;Restaurant&gt; restaurants = restaurantRepository.findAll();
        assertThat(restaurants).hasSize(1);
    }
}</pre>
                        </div>
                    </div>
                </div>

                <!-- Test Data Builders -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">ğŸ—ï¸</span>
                        <h2 class="card-title">Test Data Builders</h2>
                    </div>
                    <div class="card-content">
                        <div class="code-block">
                            <pre>public class TestDataBuilder {

    public static Restaurant createValidRestaurant() {
        return Restaurant.builder()
            .id("test-id")
            .name("Test Restaurant")
            .description("Test Description")
            .kitchenType("ITALIAN")
            .address(createValidAddress())
            .menu(Menu.builder().categories(new ArrayList&lt;&gt;()).build())
            .build();
    }

    public static Address createValidAddress() {
        return Address.builder()
            .street("Test Street, 123")
            .city("SÃ£o Paulo")
            .state("SP")
            .zipCode("01234-567")
            .build();
    }

    public static KitchenType createValidKitchenType() {
        return KitchenType.builder()
            .id("test-kitchen-id")
            .name("ITALIAN")
            .description("Italian Cuisine")
            .build();
    }
}</pre>
                        </div>
                    </div>
                </div>

                <!-- CI/CD Integration -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">ğŸ”„</span>
                        <h2 class="card-title">IntegraÃ§Ã£o CI/CD</h2>
                    </div>
                    <div class="card-content">
                        <p>Os testes sÃ£o executados automaticamente no pipeline CI/CD:</p>

                        <h3 class="mb-1">ğŸ”§ GitHub Actions</h3>
                        <div class="code-block">
                            <pre># No workflow ci.yml
- name: ğŸ§ª Run Tests
  run: |
    ./gradlew test jacocoTestReport
    
- name: ğŸ“Š Upload Coverage Reports
  uses: codecov/codecov-action@v3
  with:
    file: build/reports/jacoco/test/jacocoTestReport.xml</pre>
                        </div>

                        <h3 class="mb-1 mt-2">ğŸ“Š MÃ©tricas de Qualidade</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>MÃ©trica</th>
                                    <th>Meta</th>
                                    <th>Atual</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Cobertura de CÃ³digo</td>
                                    <td>&gt; 80%</td>
                                    <td><span class="badge badge-success">85%</span></td>
                                </tr>
                                <tr>
                                    <td>Testes UnitÃ¡rios</td>
                                    <td>100% passando</td>
                                    <td><span class="badge badge-success">âœ…</span></td>
                                </tr>
                                <tr>
                                    <td>Testes de IntegraÃ§Ã£o</td>
                                    <td>100% passando</td>
                                    <td><span class="badge badge-success">âœ…</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Best Practices -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">â­</span>
                        <h2 class="card-title">Boas PrÃ¡ticas</h2>
                    </div>
                    <div class="card-content">
                        <div class="feature-cards">
                            <div class="feature-card">
                                <div class="feature-card-icon">ğŸ“</div>
                                <h3 class="feature-card-title">Nomenclatura Clara</h3>
                                <p class="feature-card-description">
                                    Use @DisplayName com descriÃ§Ãµes em portuguÃªs
                                </p>
                            </div>

                            <div class="feature-card">
                                <div class="feature-card-icon">ğŸ¯</div>
                                <h3 class="feature-card-title">Arrange-Act-Assert</h3>
                                <p class="feature-card-description">
                                    Estruture testes com Given-When-Then
                                </p>
                            </div>

                            <div class="feature-card">
                                <div class="feature-card-icon">ğŸ”</div>
                                <h3 class="feature-card-title">Testes Isolados</h3>
                                <p class="feature-card-description">
                                    Cada teste deve ser independente
                                </p>
                            </div>

                            <div class="feature-card">
                                <div class="feature-card-icon">ğŸ“Š</div>
                                <h3 class="feature-card-title">Cobertura Significativa</h3>
                                <p class="feature-card-description">
                                    Foque em cenÃ¡rios importantes, nÃ£o apenas %
                                </p>
                            </div>
                        </div>

                        <h3 class="mb-1 mt-2">âœ… Checklist de Qualidade</h3>
                        <ul>
                            <li>âœ… Testes tÃªm nomes descritivos em portuguÃªs</li>
                            <li>âœ… CenÃ¡rios positivos e negativos cobertos</li>
                            <li>âœ… Mocks usados apropriadamente</li>
                            <li>âœ… Assertions especÃ­ficas e claras</li>
                            <li>âœ… Setup e teardown adequados</li>
                            <li>âœ… Testes rÃ¡pidos (< 1s cada)</li>
                            <li>âœ… Sem dependÃªncias externas desnecessÃ¡rias</li>
                        </ul>
                    </div>
                </div>

                <!-- Troubleshooting -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">ğŸ”§</span>
                        <h2 class="card-title">Troubleshooting</h2>
                    </div>
                    <div class="card-content">
                        <h3 class="mb-1">âŒ Problemas Comuns</h3>
                        
                        <h4 class="mb-1 mt-2">ğŸ³ TestContainers nÃ£o inicia</h4>
                        <div class="code-block">
                            <pre># Verificar Docker
docker --version
docker ps

# Limpar containers antigos
docker system prune -f

# Verificar logs
./gradlew test --info</pre>
                        </div>

                        <h4 class="mb-1 mt-2">ğŸ—„ï¸ Problemas de banco de teste</h4>
                        <div class="code-block">
                            <pre># Limpar banco de teste
./gradlew clean

# Usar banco em memÃ³ria
# application-test.yml
spring:
  data:
    mongodb:
      uri: mongodb://localhost:27017/test_db_${random.uuid}</pre>
                        </div>

                        <h4 class="mb-1 mt-2">ğŸ“Š Cobertura baixa</h4>
                        <div class="code-block">
                            <pre># Ver relatÃ³rio detalhado
./gradlew jacocoTestReport
open build/reports/jacoco/test/html/index.html

# Identificar classes nÃ£o testadas
./gradlew jacocoTestCoverageVerification --info</pre>
                        </div>
                    </div>
                </div>

                <!-- Next Steps -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">ğŸš€</span>
                        <h2 class="card-title">PrÃ³ximos Passos</h2>
                    </div>
                    <div class="card-content">
                        <div class="feature-cards">
                            <div class="feature-card" data-link="api-overview.html">
                                <div class="feature-card-icon">ğŸ“š</div>
                                <h3 class="feature-card-title">Testar API</h3>
                                <p class="feature-card-description">
                                    Use os endpoints para testar manualmente
                                </p>
                            </div>

                            <div class="feature-card" data-link="architecture-overview.html">
                                <div class="feature-card-icon">ğŸ—ï¸</div>
                                <h3 class="feature-card-title">Entender Arquitetura</h3>
                                <p class="feature-card-description">
                                    Compreenda a estrutura para criar melhores testes
                                </p>
                            </div>

                            <div class="feature-card" data-link="docker.html">
                                <div class="feature-card-icon">ğŸ³</div>
                                <h3 class="feature-card-title">Testes com Docker</h3>
                                <p class="feature-card-description">
                                    Execute testes em ambiente containerizado
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/main.js"></script>
</body>
</html>
